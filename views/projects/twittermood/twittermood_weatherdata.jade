//
   Created by hyunwoo on 2015-04-24.

extends ../../projects_layout
block body
    script(src='http://www.d3plus.org/js/d3.js')
    script(src='http://www.d3plus.org/js/d3plus.js')
    div.container-fluid
        h2
            a #2
            |  StreamGraph Example
        svg(id='viz', style='width:100%; height:500px; border:1px solid')

        legend
        h4
            a #Data :
            |  JSON Data


    div.container-fluid
        textarea(id='text',style='resize:none; width:100%; border:1px solid') #{default_data}
        legend
        div(align='right')
            a # Update

        script.
            var G_DATA;
            $(function onLoad() {
                G_DATA = document.getElementById("text").value;
                var myTextArea = document.getElementById("text");
                var myCodeMirror = CodeMirror(function (elt) {
                            console.log(elt);
                            myTextArea.parentNode.replaceChild(elt, myTextArea);
                        },
                        {
                            value: myTextArea.value,
                            lineNumbers: true,
                            lineWrapping: true,
                            theme: '3024-day',
                        }
                );
                var sample_data2 = [
                    {"num": 1, "name": "temperature", "value": 29},
                    {"num": 2, "name": "temperature", "value": 18},
                    {"num": 1, "name": "wind", "value": 2},
                    {"num": 2, "name": "wind", "value": 7},
                    {"num": 1, "name": "humidity", "value": 11},
                    {"num": 2, "name": "humidity", "value": 15},
                    {"num": 1, "name": "rain", "value": 37},
                    {"num": 2, "name": "rain", "value": 54}
                ]

                var sample_data = [
                    {"num": 1, "name": "temperature", "value": "9"}, {
                    "num": 1,
                    "name": "humidity",
                    "value": "81"
                }, ]

                var attributes1 = [
                    {"name": "alpha", "hex": "#00CC00"},
                    {"name": "beta", "hex": "#00CC00"}
                ]

                var attributes2 = [
                    {"name": "temperature", "hex": "#CC0000"},
                    {"name": "humidity", "hex": "#00CC00"},
                    {"name": "wind", "hex": "#0000CC"},
                    {"name": "rain", "hex": "#00CCCC"}
                ]

                var visualization = d3plus.viz()
                        .container("#viz")
                        .data(sample_data2)
                        .type("line")
                        .id("name")
                        .y("value")
                        .x("num")
                        .attrs(attributes2)
                        .color("hex")
                        .draw()
            });


            function testData() {
                return JSON.parse(G_DATA);
            }